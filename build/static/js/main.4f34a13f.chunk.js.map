{"version":3,"sources":["components/NavigationBar.js","components/addbook.js","components/books.js","App.js","reportWebVitals.js","index.js"],"names":["NavigationBar","props","className","cUSDBalance","AddBook","useState","author","setAuthor","title","setTitle","cover","setCover","description","setDescription","class","type","value","onChange","e","target","placeholder","onClick","addBook","Books","comment","setComment","bookks","map","book","src","userWa","owner","donate","index","addComment","comments","c","commentMessage","contractAddress","App","contract","setcontract","address","setAddress","kit","setKit","setcUSDBalance","setBooks","coms","connectToWallet","a","window","celo","enable","web3","Web3","newKitFromWeb3","eth","getAccounts","accounts","user_address","defaultAccount","console","log","alert","getBalance","useCallback","getTotalBalance","balance","USDBalance","cUSD","shiftedBy","toFixed","Contract","reader","getBooks","methods","getBooksLength","call","booksLength","books","_books","Promise","resolve","reject","getBook","numberOfcomment","push","all","_author","_title","_cover","_description","send","from","_index","_comment","Donate","cUSDContract","IERC","cost","BigNumber","toString","approve","useEffect","userWallet","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"gxJAEaA,EAAgB,SAACC,GAC5B,OAAO,8BAIL,sBAAKC,UAAU,SAAf,UACA,oBAAIA,UAAU,aAAd,8BACA,8BACQ,qCAAO,6BAAI,oBAAGA,UAAU,UAAb,UAAuB,+BAAOD,EAAME,cAApC,uBCPVC,EAAU,SAACH,GAExB,MAA4BI,mBAAS,IAArC,mBAAOC,EAAP,KAAeC,EAAf,KACA,EAA0BF,mBAAS,IAAnC,mBAAOG,EAAP,KAAcC,EAAd,KACA,EAA0BJ,mBAAS,IAAnC,mBAAOK,EAAP,KAAcC,EAAd,KACA,EAAsCN,mBAAS,IAA/C,mBAAOO,EAAP,KAAoBC,EAApB,KAGE,OAAO,8BACH,+BACJ,sBAAKC,MAAM,WAAX,UAEI,uBAAOC,KAAK,OAAOD,MAAM,eAAeE,MAAOV,EAC1CW,SAAU,SAACC,GAAD,OAAOX,EAAUW,EAAEC,OAAOH,QAAQI,YAAY,gBAE7D,uBAAOL,KAAK,OAAOD,MAAM,oBAAoBE,MAAOR,EAC/CS,SAAU,SAACC,GAAD,OAAOT,EAASS,EAAEC,OAAOH,QAAQI,YAAY,eAElE,uBAAOL,KAAK,OAAOD,MAAM,oBAAoBE,MAAON,EACzCO,SAAU,SAACC,GAAD,OAAOP,EAASO,EAAEC,OAAOH,QAAQI,YAAY,oBAElE,uBAAOL,KAAK,OAAOD,MAAM,oBAAoBE,MAAOJ,EACzCK,SAAU,SAACC,GAAD,OAAOL,EAAeK,EAAEC,OAAOH,QAAQI,YAAY,gBAElE,wBAAQL,KAAK,SAASM,QAAS,kBAAIpB,EAAMqB,QAAQhB,EAAQE,EAAOE,EAAOE,IAAcE,MAAM,oBAA3F,8B,8DCxBOS,EAAQ,SAACtB,GAElB,MAA8BI,mBAAS,IAAvC,mBAAOmB,EAAP,KAAgBC,EAAhB,KAEF,OAAO,sBAAKvB,UAAU,iBAAf,UAGRD,EAAMyB,OAAOC,KAAI,SAACC,GAAD,OACd,qBAAK1B,UAAU,QAAf,SACA,sBAAKY,MAAM,OAAX,UACA,qBAAKZ,UAAU,eAAe2B,IAAKD,EAAKlB,QACxC,sBAAKI,MAAM,aAAX,UACE,qBAAIA,MAAM,aAAV,qBAAgCc,EAAKtB,UACrC,qBAAIQ,MAAM,gBAAV,yBAAuCc,EAAKpB,SAC5C,mBAAGM,MAAM,iBAAT,SAA2Bc,EAAKhB,cAC/BX,EAAM6B,SAAWF,EAAKG,OACrB,wBAAQhB,KAAK,SAASD,MAAM,uBAAuBO,QAAU,kBAAKpB,EAAM+B,OAAOJ,EAAKK,QAApF,oBAGF,+BACJ,sBAAKnB,MAAM,SAAX,UAEI,uBAAOC,KAAK,OAAOD,MAAM,oBAAoBE,MAAOQ,EAC/CP,SAAU,SAACC,GAAD,OAAOO,EAAWP,EAAEC,OAAOH,QAAQI,YAAY,kBAE9D,wBAAQL,KAAK,SAASM,QAAS,kBAAIpB,EAAMiC,WAAWN,EAAKK,MAAOT,IAAUV,MAAM,oBAAhF,yBACA,oBAAIA,MAAM,kBAAV,sBACCc,EAAKO,SAASR,KAAI,SAACS,GAAD,OACrB,mBAAGtB,MAAM,iBAAT,SAAyCsB,EAAEC,gBAAZD,EAAEH,UARnC,gBAZ8BL,EAAKK,UAJ5B,QCgBHK,EAAkB,6CAuJTC,MAlJf,WACE,MAAgClC,mBAAS,MAAzC,mBAAOmC,EAAP,KAAiBC,EAAjB,KACA,EAA8BpC,mBAAS,MAAvC,mBAAOqC,EAAP,KAAgBC,EAAhB,KACA,EAAsBtC,mBAAS,MAA/B,mBAAOuC,EAAP,KAAYC,EAAZ,KACA,EAAsCxC,mBAAS,GAA/C,mBAAOF,EAAP,KAAoB2C,EAApB,KACA,EAA2BzC,mBAAS,IAApC,mBAAOqB,EAAP,KAAeqB,EAAf,KACA,EAAwB1C,mBAAS,IAAjC,mBAAO2C,EAAP,KAGMC,GAHN,KAGqB,uCAAG,kCAAAC,EAAA,0DAClBC,OAAOC,KADW,0CAGZD,OAAOC,KAAKC,SAHA,cAIZC,EAAO,IAAIC,IAAKJ,OAAOC,MACzBR,EAAMY,yBAAeF,GALP,SAOKV,EAAIU,KAAKG,IAAIC,cAPlB,cAOZC,EAPY,OAQZC,EAAeD,EAAS,GAE9Bf,EAAIiB,eAAiBD,EAVH,UAYZjB,EAAWiB,GAZC,yBAaZf,EAAOD,GAbK,0DAelBkB,QAAQC,IAAR,MAfkB,gCAkBpBC,MAAM,kBAlBc,0DAAH,sDAsBfC,EAAaC,sBAAW,sBAAC,gCAAAhB,EAAA,+EAELN,EAAIuB,gBAAgBzB,GAFf,OAErB0B,EAFqB,OAGrBC,EAAaD,EAAQE,KAAKC,WA5Cf,IA4C0CC,QAAQ,GAE7DhC,EAAW,IAAII,EAAIU,KAAKG,IAAIgB,SAASC,EAAQpC,GACnDG,EAAYD,GACZM,EAAeuB,GAPY,kDAS3BP,QAAQC,IAAR,MAT2B,0DAW5B,CAACrB,EAASE,IAIP+B,EAAWT,sBAAW,sBAAC,oCAAAhB,EAAA,sEACDV,EAASoC,QAAQC,iBAAiBC,OADjC,OAG3B,IAFMC,EADqB,OAErBC,EAAQ,GAFa,WAGlB/C,GACP,IAAIgD,EAAS,IAAIC,QAAJ,uCAAY,WAAOC,EAASC,GAAhB,eAAAlC,EAAA,sEACRV,EAASoC,QAAQS,QAAQpD,GAAO6C,OADxB,OACrBlD,EADqB,OAGvBuD,EAAQ,CACNlD,MAAOA,EACPF,MAAOH,EAAK,GACZtB,OAAQsB,EAAK,GACbpB,MAAOoB,EAAK,GACZlB,MAAOkB,EAAK,GACZhB,YAAagB,EAAK,GAClB0D,gBAAiB1D,EAAK,GACtBO,SAAUP,EAAK,KAXM,2CAAZ,yDAcboD,EAAMO,KAAKN,IAfJhD,EAAQ,EAAGA,EAAQ8C,EAAa9C,IAAU,EAA1CA,GAHkB,gBAsBNiD,QAAQM,IAAIR,GAtBN,OAsBrBC,EAtBqB,OAuB3BlC,EAASkC,GAvBkB,4CAwB1B,CAACzC,IAGElB,EAAO,uCAAG,WACdmE,EACAC,EACAC,EACAC,GAJc,SAAA1C,EAAA,+EAONV,EAASoC,QACZtD,QAAQmE,EAASC,EAAQC,EAAQC,GACjCC,KAAK,CAAEC,KAAMpD,IATJ,OAUZiC,IAVY,+CAYZX,MAAM,EAAD,IAZO,wDAAH,4DAgBP9B,EAAU,uCAAG,WACjB6D,EACAC,GAFiB,SAAA9C,EAAA,+EAKTV,EAASoC,QACZ1C,WAAW6D,EAAQC,GACnBH,KAAK,CAAEC,KAAMpD,IAPD,OAQfiC,IARe,+CAUfX,MAAM,EAAD,IAVU,wDAAH,wDAcViC,EAAM,uCAAG,WAAOF,GAAP,iBAAA7C,EAAA,sEAELgD,EAAe,IAAItD,EAAIU,KAAKG,IAAIgB,SAAS0B,EA7GzB,8CA8GhBC,EAAO,IAAIC,IAnHD,KAoHb9B,UArHc,IAsHd+B,WALQ,SAMLJ,EAAatB,QAChB2B,QAAQjE,EAAiB8D,GACzBP,KAAK,CAAEC,KAAMpD,IARL,uBASLF,EAASoC,QAAQ5C,OAAO+D,EAAQK,GAAMP,KAAK,CAAEC,KAAMpD,IAT9C,OAUXiC,IACAV,IACAD,MAAM,+CAZK,kDAcXA,MAAM,EAAD,IAdM,0DAAH,sDAkCZ,OAhBAwC,qBAAU,WACRvD,MACC,IAEHuD,qBAAU,WACJ5D,GAAOF,GACTuB,MAED,CAACrB,EAAKF,EAASuB,IAElBuC,qBAAU,WACJhE,GACFmC,MAED,CAACnC,EAAUmC,IAGZ,sBAAKzE,UAAU,MAAf,UACE,cAAC,EAAD,CAAeC,YAAaA,IAC5B,cAAC,EAAD,CAAOsG,WAAY/D,EAAShB,OAAQA,EAAQQ,WAAYA,EAAYF,OAAQiE,EAAQjD,KAAMA,IAC1F,cAAC,EAAD,CAAS1B,QAASA,QC7JToF,EAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,8BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,O,cCCdQ,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,SAM1Bb,M","file":"static/js/main.4f34a13f.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nexport const NavigationBar = (props) => {\r\n  return <div>\r\n\r\n\r\n\r\n    <nav className=\"navbar\"> \r\n    <h1 className=\"brand-name\">Celo Reader Dapp</h1>\r\n    <nav>\r\n            <span> <li><a className=\"balance\"><span>{props.cUSDBalance}</span>cUSD</a></li>\r\n            </span>\r\n            </nav>\r\n         \r\n    </nav>\r\n  </div>;\r\n};\r\n","import React from 'react';\r\nimport { useState } from \"react\";\r\n\r\nexport const AddBook = (props) => {\r\n\r\nconst [author, setAuthor] = useState('');\r\nconst [title, setTitle] = useState('');\r\nconst [cover, setCover] = useState('');\r\nconst [description, setDescription] = useState('');\r\n\r\n\r\n  return <div>\r\n      <form>\r\n  <div class=\"form-row\">\r\n    \r\n      <input type=\"text\" class=\"form-control\" value={author}\r\n           onChange={(e) => setAuthor(e.target.value)} placeholder=\"Author Name\"/>\r\n           \r\n      <input type=\"text\" class=\"form-control mt-2\" value={title}\r\n           onChange={(e) => setTitle(e.target.value)} placeholder=\"Book title\"/>\r\n\r\n<input type=\"text\" class=\"form-control mt-2\" value={cover}\r\n           onChange={(e) => setCover(e.target.value)} placeholder=\"Cover image url\"/>\r\n\r\n<input type=\"text\" class=\"form-control mt-2\" value={description}\r\n           onChange={(e) => setDescription(e.target.value)} placeholder=\"Description\"/>\r\n\r\n      <button type=\"button\" onClick={()=>props.addBook(author, title, cover, description)} class=\"btn btn-dark mt-2\">Add Book</button>\r\n\r\n  </div>\r\n</form>\r\n  </div>;\r\n};\r\n","import React from 'react';\r\nimport { useState } from \"react\";\r\n\r\nexport const Books = (props) => {\r\n\r\n    const [comment, setComment] = useState('');\r\n\r\n  return <div className=\"card-container\">\r\n\r\n\r\n{props.bookks.map((book) =>(\r\n    <div className='col-3' key={book.index}>  \r\n    <div class=\"card\">\r\n    <img className=\"card-img-top\" src={book.cover}  />\r\n    <div class=\"card-body \">\r\n      <h5 class=\"card-title\">Author: {book.author}</h5>\r\n      <h6 class=\"card-subtitle\">Book Title: {book.title}</h6>\r\n      <p class=\"card-text mt-2\">{book.description}</p>\r\n      {props.userWa !== book.owner && (\r\n        <button type=\"button\" class=\"btn btn-primary mt-2\" onClick={ ()=> props.donate(book.index)}>Donate</button>\r\n      )}\r\n    \r\n      <form>\r\n  <div class=\"form-r\">\r\n    \r\n      <input type=\"text\" class=\"form-control mt-4\" value={comment}\r\n           onChange={(e) => setComment(e.target.value)} placeholder=\"enter comment\"/>\r\n\r\n      <button type=\"button\" onClick={()=>props.addComment(book.index, comment)} class=\"btn btn-dark mt-2\">Add comment</button>\r\n      <h5 class=\"card-title mt-5\">Comments</h5>\r\n      {book.comments.map((c) =>(\r\n    <p class=\"card-text mt-2\" key={c.index}>{c.commentMessage}</p>\r\n       ))};\r\n  </div>\r\n</form>\r\n      \r\n    </div>\r\n  </div>\r\n  </div>\r\n  ))};\r\n\r\n</div>\r\n};\r\n","\nimport './App.css';\n\nimport { NavigationBar } from './components/NavigationBar';\nimport { AddBook } from './components/addbook';\nimport { useState, useEffect, useCallback } from \"react\";\n\n\nimport Web3 from \"web3\";\nimport { newKitFromWeb3 } from \"@celo/contractkit\";\nimport BigNumber from \"bignumber.js\";\n\n\nimport reader from \"./contracts/reader.abi.json\";\nimport IERC from \"./contracts/IERC.abi.json\";\nimport { Books } from './components/books';\n\n\nconst ERC20_DECIMALS = 18;\nconst donationPrice = \"2\";\n\n\n\nconst contractAddress = \"0x7084e7125e08b0BBAe2e1DD1ff4Fd421D3880BDF\";\nconst cUSDContractAddress = \"0x874069Fa1Eb16D44d622F2e0Ca25eeA172369bC1\";\n\n\n\nfunction App() {\n  const [contract, setcontract] = useState(null);\n  const [address, setAddress] = useState(null);\n  const [kit, setKit] = useState(null);\n  const [cUSDBalance, setcUSDBalance] = useState(0);\n  const [bookks, setBooks] = useState([]);\n  const [coms, setComs] = useState([]);\n\n\n  const connectToWallet = async () => {\n    if (window.celo) {\n      try {\n        await window.celo.enable();\n        const web3 = new Web3(window.celo);\n        let kit = newKitFromWeb3(web3);\n\n        const accounts = await kit.web3.eth.getAccounts();\n        const user_address = accounts[0];\n\n        kit.defaultAccount = user_address;\n\n        await setAddress(user_address);\n        await setKit(kit);\n      } catch (error) {\n        console.log(error);\n      }\n    } else {\n      alert(\"Error Occurred\");\n    }\n  };\n\n  const getBalance = useCallback(async () => {\n    try {\n      const balance = await kit.getTotalBalance(address);\n      const USDBalance = balance.cUSD.shiftedBy(-ERC20_DECIMALS).toFixed(2);\n\n      const contract = new kit.web3.eth.Contract(reader, contractAddress);\n      setcontract(contract);\n      setcUSDBalance(USDBalance);\n    } catch (error) {\n      console.log(error);\n    }\n  }, [address, kit]);\n\n\n\n  const getBooks = useCallback(async () => {\n    const booksLength = await contract.methods.getBooksLength().call();\n    const books = [];\n    for (let index = 0; index < booksLength; index++) {\n      let _books = new Promise(async (resolve, reject) => {\n      let book = await contract.methods.getBook(index).call();\n\n        resolve({\n          index: index,\n          owner: book[0],\n          author: book[1],\n          title: book[2],\n          cover: book[3],\n          description: book[4],\n          numberOfcomment: book[5],\n          comments: book[6]   \n        });\n      });\n      books.push(_books);\n    }\n\n\n    const _books = await Promise.all(books);\n    setBooks(_books);\n  }, [contract]);\n\n\n  const addBook = async (\n    _author,\n    _title,\n    _cover,\n    _description,\n  ) => {\n    try {\n      await contract.methods\n        .addBook(_author, _title, _cover, _description)\n        .send({ from: address });\n      getBooks();\n    } catch (error) {\n      alert(error);\n    }\n  };\n\n  const addComment = async (\n    _index,\n    _comment\n  ) => {\n    try {\n      await contract.methods\n        .addComment(_index, _comment)\n        .send({ from: address });\n      getBooks();\n    } catch (error) {\n      alert(error);\n    }\n  };\n\n  const Donate = async (_index) => {\n    try {\n      const cUSDContract = new kit.web3.eth.Contract(IERC, cUSDContractAddress);\n      const cost = new BigNumber(donationPrice)\n        .shiftedBy(ERC20_DECIMALS)\n        .toString();\n      await cUSDContract.methods\n        .approve(contractAddress, cost)\n        .send({ from: address });\n      await contract.methods.donate(_index, cost).send({ from: address });\n      getBooks();\n      getBalance();\n      alert(\"you have successfully donated to the writer\");\n    } catch (error) {\n      alert(error);\n    }};\n\n\n  useEffect(() => {\n    connectToWallet();\n  }, []);\n\n  useEffect(() => {\n    if (kit && address) {\n      getBalance();\n    }\n  }, [kit, address, getBalance]);\n\n  useEffect(() => {\n    if (contract) {\n      getBooks();\n    }\n  }, [contract, getBooks]);\n  \n  return (\n    <div className=\"App\">\n      <NavigationBar cUSDBalance={cUSDBalance} />\n      <Books userWallet={address} bookks={bookks} addComment={addComment} donate={Donate} coms={coms}/>\n      <AddBook addBook={addBook} />\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport 'bootstrap/dist/js/bootstrap.bundle.min';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}